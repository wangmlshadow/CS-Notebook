# 计算机网络

*Author:wangml*
*20210729*
*参考书籍：王道计算机考研-计算机网络*



## 计算机网络体系结构



### 1.1计算机网络概述

**计算机网络**

1. 概念
2. 组成
   1. 硬件
   2. 软件
   3. 协议
3. 功能
   1. 数据通信
   2. 资源共享
   3. 分布式处理
   4. 提高可靠性
   5. 负载均衡
4. 分类
   1. 分布范围
      1. 广域网
      2. 城域网
      3. 局域网
      4. 个人局域网
   2. 传输技术
      1. 广播式
      2. 点对点网络
   3. 拓扑结构（网络中结点的几何关系）
      1. 总线型网络
      2. 星型网络
      3. 环形网络
      4. 网状型网络
   4. 使用者
      1. 公用网
      2. 专用网
   5. 交换技术
      1. 电路交换网络
      2. 报文交换网络
      3. 分组交换网络
   6. 传输介质
5. 标准化工作
6. 性能指标
   1. 带宽b/s
   2. 时延
      1. 发送时延
      2. 传播时延
      3. 处理时延
      4. 排队时延
   3. 往返时延
   4. 吞吐量
   5. 速率
   6. 信道利用率



### 1.2网络体系结构与参考模型

1. 计算机网络分层结构
   1. 分层原则
      1. 每层相互独立，降低大系统复杂度
      2. 每一层使用下层提供的服务，并为上一层提供服务
2. 相关概念
   1. 协议，网络中数据交换遵循的规则
      1. 语法
      2. 语义
      3. 同步
   2. 接口，相邻层之间，两层交换信息的连接点
   3. 服务，相邻层之间，下层为上层提供服务
      1. 面向连接服务与无连接服务，通信前是否需要事先建立连接
      2. 可靠服务与不可靠服务，能否保证数据正确可靠的传到目的地
      3. 有应答服务和无应答服务，接收到数据后是否给发送方做出应答
3. OSI模型 TCP/IP模型
   1. OSI参考模型
      1. 应用层
      2. 表示层
      3. 会话层
      4. 传输层，报文
      5. 网络层，数据包
      6. 链路层，帧
      7. 物理层，比特
   2. TCP/IP模型
      1. 应用层
      2. 传输层
      3. 网络层
      4. 网络接口层



## 2.物理层



### 2.1通信基础

1. 基本概念
   1. 数据、信号、码元
   2. 信源、信道、信宿
   3. 速率、波特、带宽
2. Nyquist定理
3. Shannon定理
4. 编码与调制
   1. 数据变为模拟信号 调制
   2. 数据变为数字信号 编码
5. 电路交换
   1. 数据交换的过程中，始终占据端到端的固定传输带宽
   2. 优点
      1. 时延小
      2. 有序传输
      3. 没有冲突
      4. 适用范围广
      5. 实时性强
      6. 控制简单
   3. 缺点
      1. 建立连接时间长
      2. 线路独占
      3. 灵活性差
      4. 难以规格化
6. 报文交换
   1. 报文是数据交换的基本单位，报文携带数据源地址与目的地址的信息，报文交换在交换节点采用存储转发的传输方式
   2. 优点
      1. 无需建立连接
      2. 动态分配线路
      3. 提高线路的可靠性
      4. 提高线路利用率
      5. 提供多目标服务
   3. 缺点
      1. 存储转发带来的时延
      2. 报文转发的报文大小没有限制，要求网络节点的缓存足够大
7. 分组交换
   1. 分组交换也采用存储转发的形式，但是限制了每次传输数据块的大小上限
   2. 优点
      1. 无建立时延
      2. 线路利用率高
      3. 相较于报文交换，由于分组的长度固定，存储管理得以简化
      4. 加速传输
      5. 减少了出错概率和重发数据量
   3. 缺点
      1. 传输时延
      2. 需要传输额外的信息 5%-10%
8. 数据报与虚电路
   1. 分组交换根据其通信子网向断电系统提供的服务，进一步划分为面向连接的虚电路方式和无连接的数据报方式
   2. 数据报：将报文拆分为一个个带有序号数据单元，再转发
      1. 发送前不建立连接
      2. 不保证可靠性
      3. 发送的分组包括接收端和发送端的地址，每一个分组可以独立传输
      4. 分组在交换节点存储转发带来时延
      5. 对网络中某条线路出现故障时，更新转发表，对故障的适应能力强
      6. 存储转发的时延一般较小，提高了网络吞吐量
      7. 收发双方不占据一条线路，资源利用率高
   3. 虚电路：分组发送前，收发双方需要建立一条逻辑上相连的虚拟电路
      1. 虚电路的建立与销毁需要时间开销
      2. 虚电路的路由选择在逻辑线路建立后，传输路径就确定了
      3. 提供可靠的通信功能，保证分组有序、正确的到达，提供流量控制
      4. 逻辑线路中某个结点故障，虚电路就会被破坏
      5. 分组首部不包含目的地地址，而是虚电路标识，相对于包含目的地地址，开销更小



### 2.2传输介质

1. 双绞线、同轴电缆、光纤
2. 无线传输介质
3. 物理层接口的特性
   1. 机械特性
   2. 电气特性
   3. 功能特性
   4. 规程特性



## 3.数据链路层



### 3.1数据链路层的功能

**数据链路层在物理层提供的服务的基础上向网络层提供服务，主要作用时加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造成逻辑上无差错的数据链路，使之对网络层表现为一条无差错的链路**

1. 为网络层提供服务
   1. 无确认的无连接服务，以太网
   2. 有确认的无连接服务，无线通信
   3. 有确认的面向连接的服务
2. 链路管理，数据链路层连接的建立、维持、释放
3. 帧定界、帧同步、透明传输
4. 流量控制
   1. 收发双方工作速率和缓存空间差异，造成接受能力与发送能力不对等
   2. 控制相邻节点之间数据链路上的流量
5. 差错控制
   1. CRC循环冗余校验
   2. ARQ自动重传请求



### 3.2组帧

**通过帧的首部尾部将网络信息的比特流中将帧区分出来**

1. 字符计数法，在帧头部使用一个计数字段标明帧内字符数
2. 字符填充的首尾定界符法
3. 零比特填充的首位标志法
4. 违规编码法



### 3.3差错控制

1. 检错编码
   1. 奇偶校验码
   2. 循环冗余码
2. 纠错编码



### 3.4流量控制和可靠传输机制

1. 停止-等待协议，发送方发送每一帧后需要等待接收方的应答信号才能发送下一帧
2. 滑动窗口机制，
3. 可靠传输机制
   1. 通过确认个超时重传机制实现
4. 单帧滑动窗口与停止-等待协议
5. 多帧滑动窗口与后退N帧协议
6. 多帧滑动窗口与选择重传协议



### 3.5介质访问控制

**介质访问控制的目的地是，为使用介质的每个节点隔离来自同一信道上其他节点所传送的信号**

1. 信道划分
   1. 频分多路复用
   2. 时分多路复用
   3. 波分多路复用
   4. 码分多路复用
2. 随机访问介质访问控制
   1. ALOHA协议
   2. CSMA协议（载波侦听多路访问）
   3. CSMA/CD协议
   4. CSMA/CA协议
3. 轮询访问介质访问控制：令牌传递协议



### 3.6局域网

1. 局域网的基本概念和体系结构
   1. 三种特殊的局域网拓扑实现
      1. 以太网
      2. 令牌环网
      3. FDDI



### 3.7广域网



## 4.网络层



### 4.1网络层的功能

1. 异构网络互联
   1. 中继系统
      1. 物理层：中继器、集线器
      2. 链路层：网桥或交换机
      3. 网络层：路由器
      4. 网络层以上的：网关
   2. 路由与转发
      1. 路由器的功能：
         1. 路由选择
         2. 分组转发
   3. 拥塞控制
      1. 拥塞：因出现过量分组而引起的网络性能下降的现象
      2. 网络吞吐量随着网络负载的增加而下降则表示可能进入拥塞状态
      3. 流量控制和拥塞控制：流量控制主要解决收发双方通信流量控制的问题，而拥塞控制必须确保通信子网能够传送待传送的数据，是一个全局性的问题
      4. 拥塞控制的方法：
         1. 开环控制：静态的预防方法，再设计网络时做出的控制
         2. 闭环控制：动态的在网络运行时通过检测网络系统检测拥塞并解决



### 4.2路由算法

1. 静态路由与动态路由
   1. 静态路由算法
      1. 网络管理员手动配置路由信息
   2. 动态路由算法
      1. 通过相互连接的路由器之间彼此交换信息，然后按照一定算法优化出
2. 距离-向量路由算法
   1. 所有节点定期将整个路由选择表传递给所有与之直接相邻的节点，路由选择表包括每条路径的目的地与距离
   2. 路由选择表更新
      1. 被告知一条新的路由
      2. 发来的路由信息显示存在一条距离更近的到达某已知目的地的路径
      3. 更新报文的大小与通信子网中结点个数成正比
3. 链路状态路由算法
   1. 每个参与算法的节点都具有完全的网络拓扑信息
   2. 主动测试所有相邻节点的状态，定期将链路状态传播给所有其他节点
   3. 典型的链路状态算法：OSPF
   4. 每当收到链路状态报文，一旦链路状态发生变化，则通过最短路径算法重新计算路由
   5. 链路状态路由算法的特征
      1. 向本自治系统所有节点发送信息
      2. 发送的信息只是与本节点相邻的所有节点的链路状态信息，这只是节点知道的部分信息
      3. 只有当链路状态发生变化时才发送此信息
4. 层次路由
   1. 路由选择协议划分
      1. 自治系统内部使用的：内部网关协议IGP，具体有RIP、OSPF
      2. 自治系统之间使用的：外部网关协议EGP，具体有BGP



### 4.3IPv4

1. IPv4分组
   1. 分组格式：首部+数据
   2. 首部字段
      1. 版本
      2. 首部长度
      3. 总长度
      4. 标识
      5. 标志
      6. 片偏移
      7. 首部校验和
      8. 生存时间TTL
      9. 协议
      10. 源地址字段
      11. 目的地地址字段
   3. IP数据报分片
      1. 链路层数据报能承受的最大数据量为最大传送单元MTU
      2. IP数据报总长度大于MTU时，将一个IP数据报分装到多个较小的IP数据报中，这些较小的数据报称为片
   4. 网络层转发分组的流程
2. IPv4与NAT
   1. IPv4地址分类：ABCDE
   2. 网络地址转换NAT：将专用的网络地址转换为公用地址，从而对外隐藏内部管理的IP地址
3. 子网划分与子网掩码、CIDR
   1. 子网划分
   2. 子网掩码
   3. 无分类域间路由选择CIDR
4. ARP、DHCP、ICMP
   1. IP地址与硬件地址
   2. ARP地址解析协议：IP地址到MAC地址的映射
   3. DHCP动态主机配置协议：给主机动态的分配IP地址，即插即用，基于UDP
   4. ICMP网际控制报文协议：让主机和路由器报告差错和异常情况
      1. ICMP差错报告报文
         1. 终点不可达
         2. 源点抑制
         3. 时间超过
         4. 参数问题
         5. 改变路由（重定向）
      2. ICMP询问报文



### 4.4IPv6

1. 解决IP地址耗尽的措施：
   1. 使用五类别编制CIDR，它消除了传统的A类、B类和C类地址以及划分子网的概念，因而可以更加有效地分配IPv4的地址空间。它可以将好几个IP网络结合在一起，使用一种无类别的域际路由选择算法，使它们合并成一条路由从而较少路由表中的路由条目减轻Internet路由器的负担。
   2. 采用网络地址转换NAT的方式
   3. 采用具有更大地址空间的IPv6
2. 特点
   1. 更大的地址空间，由IPv4的32位增大到128位
   2. 扩展的地址层次结构
   3. 灵活的首部格式
   4. 改进的选项
   5. 允许协议继续扩充
   6. 支持即插即用
   7. 支持资源的预分配
   8. IPv6只有在包的源节点才能分片，是端到端的，传输路径中的路由器不能分片
   9. IPv6的首部长度必须是8B的整数倍，IPv4首部是4B的整数倍
   10. 增大了安全性，IPv6具有身份验证和保密功能
3. IPv6地址
   1. IPv6的目的地址可以是以下三种基本类型地址之一
      1. 单播
      2. 多播
      3. 任播，目的站是一组计算机，当数据报交付时只交付其中一台计算机，通常是距离最近的
   2. IPv4通常使用点分十进制的方式表示，IPv6将地址中每4位用一个十六进制数表示
   3. IPv6扩展了Ipv4的分级，使得路由器能够更快的查找路由
      1. 顶级，全球都知道的公共拓扑
      2. 场点级，指明单个场点
      3. 第三级，指明单个网络接口
   4. IPv4向IPv6过渡
      1. 双协议栈，同时拥有Ipv4和IPv6
      2. 隧道技术，将整个IPv6数据报封装到IPv4数据报的数据部分，使得IPv6可以在IPv4网络的隧道中传输



### 4.5路由协议

1. 自治系统AS，单一技术管理下的一组路由器
2. 域内路由和域间路由，AS内和AS之间
   1. 内部网关协议IGP
      1. RIP
      2. OSPF
   2. 外部网关协议EGP
      1. BGP-4
3. 路由信息协议RIP，基于距离向量的路由选择协议
   1. 规定
      1. 每个路由器维护它自身到其他每个目的网络的距离记录
      2. 距离也就是跳数，每经过一个路由器，跳数加一
      3. 跳数最小的路径最好
      4. 一条路径最多允许15跳，超过15认为目的地不可达，规定跳数上限是为了防止数据报不断循环在环路上，减少网络拥塞的可能性
      5. 任意两个RIP路由器，默认30秒广播一次路由更新信息
      6. 不支持子网掩码的RIP广播，RIP中每个网络的子网掩码必须相同，RIP2支持变长子网掩码和CIDR
   2. 特点
      1. 仅和相邻路由交换信息
      2. 交换的信息是自己的全部信息，路由表
      3. 固定时间间隔交换信息
4. 开放最短路径优先协议OSPF
   1. 特点
      1. 向本自治系统内所有路由器发送信息，洪泛法
      2. 发送的信息时本路由器相邻的所有路由器的链路状态，本路由器知道的部分信息
      3. 只有当链路状态发生变化时发送此信息
      4. OSPF是网络层协议，直接用IP数据报传送，RIP为应用层协议，它在传输层使用UDP
      5. 可以根据IP分组的不同服务类型而设置不同的代价
      6. 可以多路径间负载平衡
      7. 支持可变长度的子网划分和CIDR
      8. 每个链路状态都带上一个32位序号，序号越大，状态越新
   2. 分组类型
      1. 问候分组
      2. 数据库描述分组
      3. 链路状态请求分组
      4. 链路状态更新分组
      5. 链路状态确认分组
5. 边界网关协议BGP，不同自治系统的路由器之间交换路由信息的协议
   1. 应用层协议，使用TCP传输
   2. 特点
      1. BGP交换路由信息的节点数量级是自治系统的数量级，比自治系统中的网络数少很多
      2. 每个AS中BGP发言人的数目很少，使得AS之间的路由选择不至于过分复杂
      3. 支持CIDR
      4. BGP在运行时与相邻AS交换整个BGP路由表，以后只在发生变化时更新有变化的部分
   3. 报文
      1. 打开报文
      2. 更新报文
      3. 保活报文
      4. 通知报文



### 4.6IP组播

1. 概念
   1. 为了支持视频点播与网络会议类的多媒体应用
   2. 使用单播传输会引起主机上的大量处理开销和网络上太多的交通量
   3. 组播机制让源计算机一次发送的单个分组可以抵达一个组地址标识的若干目标主机
   4. 应用于UDP而不是TCP
   5. 主机使用因特网组管理协议IGMP加入组播组
   6. 能够运行组播协议的路由器称为组播路由器
2. IP组播地址
   1. IP组播使用D类地址，前四位为1110
   2. 特点
      1. 尽最大努力交付而非可靠交付
      2. 组播地址只能用于目的地地址
      3. 组播数据报不产生ICMP差错报文，ping一个组播地址是不会收到响应的
      4. 并非所有D类地址都可以作为组播地址
3. 因特网组管理协议IGMP和组播路由算法
   1. IGMP让连接到本地局域网上的组播路由器知道本局域网上是否有主机参加或推出了某个组播组
   2. 组播路由选择就是找出以源主机为根节点的组播转发树



### 4.8网络层设备

1. 路由器的组成和功能
   1. 多个输入输出端口的专用计算机
   2. 同一个网络直接交付，否则间接交付
   3. 网络层设备
   4. 功能
      1. 分组转发
      2. 路由计算
2. 路由表与路由转发



## 5.传输层



### 5.1传输层提供的服务

1. 功能
   1. 向应用层提供服务，属于面向通信部份的最高层，同时也是用户功能中的最底层
   2. 提供应用进程之间的逻辑通信，网络层提供的是主机之间的逻辑通信
   3. 复用和分用，
      1. 复用，发送方多个进程可以使用同一个传输层协议传递数据‘
      2. 分用，接收方在剥去报文首部后可以将数据交付到正确的应用进程
   4. 差错检测，首部和数据部分，网络层只检测IP数据报的首部，不检验数据部分是否出错
   5. TCP+UDP
2. 传输层的寻址与端口
   1. 应用和传输层的数据交流通过端口
   2. 应用进程通过端口号进行标识
      1. 服务端端口号
         1. 熟知端口号0-1023
         2. 登记端口号1024-49151
      2. 客户端使用的端口号49152-65535，客户进程运行时动态选择
   3. 套接字，IP+Port
3. 无连接服务和面向连接的服务
   1. TCP
   2. UDP



### 5.2UDP协议

1. UDP数据报
   1. 优点
      1. 无需建立连接
      2. 无连接状态
      3. 分组首部开销小
      4. 应用层可以更好的控制要发送的数据和发送时间
   2. 首部格式
      1. 源端口
      2. 目的端口
      3. 长度
      4. 校验和
2. UDP校验



### 5.3TCP协议

1. 特点
   1. 面向连接
   2. TCP只能是点对点的
   3. 提供可靠的交付通信，保证数据无差错、不丢失、不重复、有序
   4. 全双工通信
   5. 面向字节流
2. 报文段
   1. TCP报文段既可以传输数据，也可以用来建立连接、释放连接、应答
   2. 字段
      1. 源端口和目的端口
      2. 序号字段
      3. 确认号
      4. 数据偏移
      5. 保留字段
      6. 紧急位URG
      7. 确认位ACK
      8. 推送位PSH
      9. 复位位RST
      10. 同步位SYN
      11. 终止位FIN
      12. 窗口字段
      13. 校验和
      14. 紧急指针字段
      15. 选项字段
      16. 填充字段
3. TCP连接管理
   1. TCP连接建立
      1. 三次握手
   2. TCP连接的释放
      1. 四次握手
4. TCP可靠传输
   1. 通过校验、序号、确认、重传来保证可靠传输
   2. 序号
      1. TCP将数据视为一个无结构但有序的字节流，TCP传送的数据流中每个字节都编上一个序号
   3. 确认
      1. 确认号是期望收到对方的下一个报文段的数据的第一个字节的序号
      2. TCP只确认数据流中至第一个丢失字节为止的字节
   4. 重传
      1. 超时重传
         1. 设置一个略大于往返时间的超时重传时间，重传时间会自动改变
      2. 冗余ACK
         1. 冗余ACK，再次确认某个报文段的ACK，而发送方之前已经受到过该报文段的确认
         2. TCP规定当发送方收到同一个报文段的3个冗余ACK，就可以确认跟在这个报文段之后的报文已经丢失
5. TCP流量控制
   1. 消除发送方使得接收方缓冲区溢出的可能性
   2. 采用基于滑动窗口协议的流量控制机制
   3. 接收方通过确认报文中首部的窗口字段向发送方说明自己可以接受多少数据
6. TCP拥塞控制
   1. 防止过多数据注入网络，保证网络中的路由器或链路不过载
   2. 和流量控制一样，通过控制发送发发送数据的熟虑进行拥塞控制
   3. 拥塞控制是让网络能承受现在的载荷，是一个全局过程
   4. 传输层拥塞控制算法
      1. 慢开始
         1. 每一个传输轮次（一个往返时间RTT），拥塞窗口大小加倍，直到拥塞窗口大小达到一个规定的慢开始门限（阈值），再改用拥塞避免算法
         2. 指数增长
      2. 拥塞避免
         1. 拥塞窗口每经过一个RTT就增加一个最大报文段长度MSS的大小，当出现一次超时，将慢开始门限变为当前拥塞窗口大小的一半
         2. 线性增长
         3. 拥塞窗口小于阈值，采用慢开始
         4. 拥塞窗口大于阈值，使用拥塞避免
         5. 两者相等，1 2 都可用
         6. 网络拥塞的处理，不论在哪个阶段，只要发送方检测到网络拥塞，就要把慢开始阈值变为当前拥塞窗口的一半
      3. 快重传
         1. 利用冗余ACK来检测网络拥塞，快重传并不是取消重传计时器，而是在某些情况下更早的重传丢失的报文段
         2. 发送方连续收到三个重复的ACK报文时，直接重传对方未收到的报文，不必等待此报文的重传计时器超时
      4. 快恢复
         1. 收到三个冗余ACK报文时，将发送方慢开始门限设为拥塞窗口大小的一半，再拥塞窗口大小改为当前门限值
   5. TCP要求发送方维护两个窗口
      1. 接收窗口
      2. 拥塞窗口



## 6.应用层



### 6.1网络应用模型

1. C/S模型
   1. 特点
      1. 客户是服务的请求方，服务器是服务的提供方
      2. 网络中各计算机地位不相等
      3. 客户机之间不互相通信
      4. 可扩展性不佳
      5. 服务器性能决定系统性能
2. P2P模型
   1. 整个网络中的传输内容不在保存在中心服务器上，每个节点同时具有下载、上传功能，每个节点权力和义务大体对等
   2. 相对于C/S模型，P2P模型的优点
      1. 减轻服务器的计算压力，消除对某个服务器的依赖
      2. 可扩展性好
      3. 网络健壮性强
   3. 缺点
      1. 各节点的获取服务时为其他节点提供服务



### 6.2DNS

1. 提供域名与IP的转换服务
2. 采用C/S模型，UDP协议
3. 层次域名空间
   1. 顶级域名分类
      1. 国家顶级域名，cn，uk
      2. 通用顶级域名，com，org
      3. 基础结构域名，只有一个，arpa，用于反向域名解析
   2. 根->顶级域名->二级域名->三级域名->
4. 域名服务器
   1. 因特网的域名系统被设计成一个联机分布式数据库系统
   2. 根域名服务器
   3. 顶级域名服务器
   4. 授权域服务器本地域名服务器
5. 域名解析过程
   1. 域名与IP地址相互映射的过程
   2. 当客户端需要域名解析时，通过本机的DNS客户端构造一个DNS请求报文，以UDP数据报的方式发往本地域名服务器
   3. 域名解析的方式
      1. 递归查询
      2. 递归和迭代相结合
   4. 主机向本地域名服务器的查询采用递归查询
   5. 本地域名服务器向根域名服务器的查询采用迭代查询



### 6.3FTP

1. 工作原理
   1. 采用C/S模型，使用TCP
2. 控制链接和数据连接
   1. FTP在工作时有两个并行的TCP连接
   2. 控制连接用于传输控制信息，
   3. 数据连接传数据



### 6.4电子邮件

1. 组成结构
   1. 用户代理
   2. 邮件服务器
   3. 电子邮件使用的协议
2. SMTP
3. POP3



### 6.5www

1. 组成结构
   1. URL
   2. HTTP
   3. HTML
2. HTTP超文本传输协议
   1. 基于TCP
   2. 特点
      1. 无状态